<!DOCTYPE html>
<html class="no-js">
    {% include head.html %}
    <body>
      <div class="skyline js-skyline">
        <div class="intro js-view" data-view="Intro">
          <h3 class="lined-heading">FLAGTEST.NZ</h3>
          <p class="intro-text">See how a flag design works in a raging <span class="desktop-break"></span>New Zealand southerly or a gentle nor'wester...</p>
          <div class="intro-actions">
            <button class="btn skyline-upload js-view" data-view="Upload">
              Upload &amp; test a flag
              <input type="file" class="js-upload skyline-upload-input" />
            </button>
            &nbsp;
            <button class="btn js-random">View a random flag</button>
          </div>
          <p class="intro-submit">Looking to submit a design? <a href="http://flag.govt.nz" target="_blank">Visit the official site Â»</a></p>
        </div>
      </div>
      {{ content }}
      {% include footer.html %}
      <script src="/assets/js/vendor/three50dev2.js"></script>
      <script src="/assets/js/vendor/flag-physics.js"></script>
      <script src="/assets/js/flag3d.js"></script>
      <script type="x-shader/x-fragment" id="fragmentShaderDepth">
  			uniform sampler2D texture;
  			varying vec2 vUV;
  			vec4 pack_depth( const in float depth ) {
  				const vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );
  				const vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );
  				vec4 res = fract( depth * bit_shift );
  				res -= res.xxyz * bit_mask;
  				return res;
  			}
  			void main() {
  				vec4 pixel = texture2D( texture, vUV );
  				if ( pixel.a < 0.5 ) discard;
  				gl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );
  			}
  		</script>
  		<script type="x-shader/x-vertex" id="vertexShaderDepth">
  			varying vec2 vUV;
  			void main() {
  				vUV = 0.75 * uv;
  				vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );
  				gl_Position = projectionMatrix * mvPosition;
  			}
  		</script>
      <script src="/assets/js/app.js"></script>
    </body>
</html>
